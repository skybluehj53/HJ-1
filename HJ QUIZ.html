<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>HJ Quiz Site</title>
  <!-- React, ReactDOM, Babel CDN -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <!-- React 루트 -->
  <div id="root"></div>

  <!-- JSX 코드 -->
  <script type="text/babel">
    const { useState } = React;

    function App() {
      const [quizType, setQuizType] = useState(null);
      const [currentQuestion, setCurrentQuestion] = useState(0);
      const [score, setScore] = useState(0);
      const [showScore, setShowScore] = useState(false);
      const [adminMode, setAdminMode] = useState(false);
      const [quizzes, setQuizzes] = useState({
      
        general: [
          { question: '(경제) 일정기간 가계 소비지출 총액에서 식료품비가 차지하는 비율로서, 가계의 생활수준을 가늠하는 척도. OO 지수', options: [], answer: '엥겔', type: 'text'},
          { question: '(사자성어) 능력과 재주가 뛰어난 사람은 스스로 두각을 나타낸다는 뜻으로, 송곳은 가만히 있어도 주머니를 뚫고 나온다는 고사성어는?',  options: [], answer: '낭중지추', type: 'text'},
          { question: '(사자성어) 간과 쓸개를 서로 드러내 보인다는 뜻으로, 당나라의 한유와 유종원 사이의 우정을 가리키는 사자성어는?',  options: [], answer: '간담상조', type: 'text'},
          { question: '(국어) 과녁의 한가운데를 가리키는 이 말은 솔개와 고니를 뜻하는 한자어로, 이 새들은 매우 민첩하고 높이 날기 때문에 활로 맞히기 힘든 것에서 유래했다. 어떤 일의 핵심을 간파했다는 뜻으로 "이것을 찌르다" 라고 하는 이 단어는?',  options: [], answer: '정곡', type: 'text'},
          { question: '(용어) 열주(줄지어 늘어선 기둥)에 의해 지탱되는 아치군과 그것이 조성하는 개방된 통로공간을 뜻하는 용어로, 대표적으로 콜로세움이나 폼페이의 유적 등이 있다. 현재는 양쪽에 상점이 즐비한 도로에 지붕을 덮은 상점가를 말하는 이 단어는?',  options: [], answer: '아케이드', type: 'text'},
          { question: '(지리) 석회암이 풍화되고 남은 불순물이 잔류하여 이루어진 점토질의 적색 토양으로, 라틴어로 "붉은 장밋빛 토양"이라는 뜻이다. 여름에 건조하고 겨울에 습윤한 지중해성 기후 하에서 많이 분포하는 이것은?',  options: [], answer: '테라로사', type: 'text'},
          { question: '(문학) 미국의 생물학자 레이첼 카슨이 쓴 책으로, 유기염소계 농약인 DDT 등 여러 종류의 농약이 동물과 인간에게 끼치는 악영향을 밝혀 자연 보호와 환경보전의 중요함을 널리 인식시킨 책은?',  options: [], answer: ['침묵의봄', '침묵의 봄'], type: 'text'},
          { question: '(영화,연극) 연극에서의 개막이나 개막 전 해설을 "프롤로그", 극의 종말에 추가한 끝 대사나 장면을 "에필로그"라 한다. 배우가 상대자 없이 혼자서 말하는 독백을 이르는 외래어는?', options: [], answer: '모놀로그', type: 'text'}
          { question: '(의학) "나쁜 공기"에서 유래한 용어로 예전에는 나쁜 공기를 통해 전파된다고 믿어서 붙은 이름의 질병으로, 나중에 모기가 전파한다는 사실일 밝혀진 이것은?',  options: [], answer: '말라리아', type: 'text'},
          { question: '(음악) "음이 높은 나무피리"라는 뜻의 프랑스어에서 이름이 유래한 악기. 바로크 시대의 대표적인 목관악기로 동양적인 애수를 띤 음색이 특색으로 꼽히는 이것은?',  options: [], answer: '오보에', type: 'text'},

        ]
      });
      const [newQuizName, setNewQuizName] = useState('');
      const [newQuestion, setNewQuestion] = useState({ question: '', options: '', answer: '', type: 'mcq' });

     const handleAnswerOptionClick = (selected) => {
  const correctAnswer = quizzes[quizType][currentQuestion].answer;
  
  let isCorrect = false;

  if (Array.isArray(correctAnswer)) {
    // 정답이 여러 개면 배열 안의 값들과 비교
    isCorrect = correctAnswer.some(
      ans => selected.trim().toLowerCase() === ans.trim().toLowerCase()
    );
  } else {
    // 정답이 하나면 문자열 비교
    isCorrect = selected.trim().toLowerCase() === correctAnswer.trim().toLowerCase();
  }

  if (isCorrect) {
    setScore(score + 1);
  }

  const nextQuestion = currentQuestion + 1;
  if (nextQuestion < quizzes[quizType].length) {
    setCurrentQuestion(nextQuestion);
  } else {
    setShowScore(true);
  }
};

      const startQuiz = (type) => {
        setQuizType(type);
        setCurrentQuestion(0);
        setScore(0);
        setShowScore(false);
      };

      const addQuiz = () => {
        if (newQuizName && !quizzes[newQuizName]) {
          setQuizzes({ ...quizzes, [newQuizName]: [] });
          setNewQuizName('');
        }
      };

      const addQuestion = () => {
        if (quizType && newQuestion.question && newQuestion.answer) {
          const optionsArr = newQuestion.type === 'mcq' ? newQuestion.options.split(',').map(o => o.trim()) : [];
          const updatedQuiz = [...quizzes[quizType], { ...newQuestion, options: optionsArr }];
          setQuizzes({ ...quizzes, [quizType]: updatedQuiz });
          setNewQuestion({ question: '', options: '', answer: '', type: 'mcq' });
        }
      };

      const deleteQuestion = (index) => {
        const updatedQuiz = quizzes[quizType].filter((_, i) => i !== index);
        setQuizzes({ ...quizzes, [quizType]: updatedQuiz });
      };

      return (
        <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-blue-300 to-blue-600 text-white p-4">
          <h1 className="text-4xl font-bold mb-8">HJ Quiz Site</h1>
          {!adminMode && (
            <button onClick={() => setAdminMode(true)} className="mb-4 px-4 py-2 bg-gray-800 rounded">Admin Login</button>
          )}
          {adminMode && (
            <button onClick={() => setAdminMode(false)} className="mb-4 px-4 py-2 bg-red-600 rounded">Exit Admin</button>
          )}
    
          {!quizType ? (
            <div className="space-y-4 w-full max-w-md">
              <div className="flex space-x-4 flex-wrap">
                {Object.keys(quizzes).map((quiz) => (
                  <button key={quiz} onClick={() => startQuiz(quiz)} className="px-6 py-3 bg-white text-blue-600 rounded-lg shadow hover:bg-gray-100">{quiz} Quiz</button>
                ))}
              </div>
              {adminMode && (
                <div className="mt-4 flex space-x-2">
                  <input value={newQuizName} onChange={(e) => setNewQuizName(e.target.value)} placeholder="New quiz name" className="px-2 py-1 rounded text-black" />
                  <button onClick={addQuiz} className="px-4 py-1 bg-white text-blue-600 rounded">Add Quiz</button>
                </div>
              )}
            </div>
          ) : showScore ? (
            <div className="text-center">
              <p className="text-2xl mb-4">You scored {score} out of {quizzes[quizType].length}</p>
              <button onClick={() => setQuizType(null)} className="px-6 py-3 bg-white text-blue-600 rounded-lg shadow hover:bg-gray-100">Go Back</button>
            </div>
          ) : (
            <div className="w-full max-w-md bg-white text-blue-800 rounded-lg shadow p-6 space-y-4">
              <h2 className="text-xl">Question {currentQuestion + 1}/{quizzes[quizType].length}</h2>
              <p>{quizzes[quizType][currentQuestion].question}</p>
              {quizzes[quizType][currentQuestion].type === 'mcq' ? (
                <div className="space-y-2">
                  {quizzes[quizType][currentQuestion].options.map((option, index) => (
                    <button key={index} onClick={() => handleAnswerOptionClick(option)} className="w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-700">
                      {option}
                    </button>
                  ))}
                </div>
              ) : (
                <div className="space-y-2">
                  <input type="text" placeholder="Your answer"
                    onKeyDown={(e) => { if (e.key === 'Enter') handleAnswerOptionClick(e.target.value); }}
                    className="w-full px-2 py-1 border rounded" />
                  <button onClick={() => {
                    const input = document.querySelector('input[type=text]').value;
                    handleAnswerOptionClick(input);
                  }} className="px-4 py-2 bg-blue-500 text-white rounded">Submit</button>
                </div>
              )}
              {adminMode && (
                <div className="mt-4 p-4 border-t">
                  <h3 className="font-bold">Add / Edit Questions</h3>
                  <input value={newQuestion.question} onChange={(e) => setNewQuestion({ ...newQuestion, question: e.target.value })} placeholder="Question" className="w-full mb-2 px-2 py-1 rounded border" />
                  <select value={newQuestion.type} onChange={(e) => setNewQuestion({ ...newQuestion, type: e.target.value })} className="w-full mb-2 px-2 py-1 rounded border">
                    <option value="mcq">Multiple Choice</option>
                    <option value="text">Short Answer</option>
                  </select>
                  {newQuestion.type === 'mcq' && (
                    <input value={newQuestion.options} onChange={(e) => setNewQuestion({ ...newQuestion, options: e.target.value })} placeholder="Options (comma separated)" className="w-full mb-2 px-2 py-1 rounded border" />
                  )}
                  <input value={newQuestion.answer} onChange={(e) => setNewQuestion({ ...newQuestion, answer: e.target.value })} placeholder="Answer" className="w-full mb-2 px-2 py-1 rounded border" />
                  <button onClick={addQuestion} className="px-4 py-1 bg-blue-500 text-white rounded">Add Question</button>
                  <div className="mt-4">
                    {quizzes[quizType].map((q, i) => (
                      <div key={i} className="flex justify-between items-center border-b py-1">
                        <span>{q.question}</span>
                        <button onClick={() => deleteQuestion(i)} className="px-2 py-1 bg-red-500 text-white rounded">Delete</button>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
